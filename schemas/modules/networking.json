{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://anglesite.dwk.io/schemas/modules/networking.json",
  "title": "Networking and Server Configuration Schema",
  "type": "object",
  "definitions": {
    "redirectRule": {
      "type": "object",
      "description": "A redirect rule",
      "required": ["source", "destination"],
      "properties": {
        "source": {
          "type": "string",
          "description": "Source path or pattern"
        },
        "destination": {
          "type": "string",
          "description": "Destination path or URL"
        },
        "code": {
          "$ref": "./common.json#/definitions/httpStatusCode",
          "description": "HTTP redirect status code",
          "default": 302
        },
        "force": {
          "type": "boolean",
          "description": "Force redirect even if file exists"
        }
      },
      "additionalProperties": false
    }
  },
  "properties": {
    "headers": {
      "type": "object",
      "description": "HTTP headers to set",
      "properties": {
        "X-Frame-Options": {
          "type": "string",
          "enum": ["DENY", "SAMEORIGIN"],
          "description": "Controls whether the page can be displayed in a frame"
        },
        "X-Content-Type-Options": {
          "type": "string",
          "enum": ["nosniff"],
          "description": "Prevents MIME type sniffing"
        },
        "X-XSS-Protection": {
          "type": "string",
          "description": "XSS protection mode"
        },
        "Referrer-Policy": {
          "type": "string",
          "enum": [
            "no-referrer",
            "no-referrer-when-downgrade",
            "origin",
            "origin-when-cross-origin",
            "same-origin",
            "strict-origin",
            "strict-origin-when-cross-origin",
            "unsafe-url"
          ]
        },
        "Strict-Transport-Security": {
          "type": "string",
          "description": "HSTS header value"
        },
        "Content-Security-Policy": {
          "type": "string",
          "description": "CSP header value"
        },
        "Permissions-Policy": {
          "type": "string",
          "description": "Permissions policy header"
        },
        "Cross-Origin-Embedder-Policy": {
          "type": "string",
          "enum": ["unsafe-none", "require-corp", "credentialless"]
        },
        "Cross-Origin-Opener-Policy": {
          "type": "string",
          "enum": ["unsafe-none", "same-origin-allow-popups", "same-origin"]
        },
        "Cross-Origin-Resource-Policy": {
          "type": "string",
          "enum": ["same-site", "same-origin", "cross-origin"]
        },
        "Cache-Control": {
          "type": "string",
          "description": "Cache control directives"
        },
        "Expires": {
          "type": "string",
          "description": "Expiration date/time"
        },
        "Vary": {
          "type": "string",
          "description": "Vary header for cache invalidation"
        },
        "Server": {
          "type": "string",
          "description": "Server identification (use with caution)"
        },
        "NEL": {
          "type": "string",
          "description": "Network Error Logging policy"
        }
      },
      "additionalProperties": false
    },
    "redirects": {
      "type": "array",
      "description": "Redirect rules",
      "items": {
        "$ref": "#/definitions/redirectRule"
      }
    }
  }
}
